(()=>{"use strict";var e={};chrome.runtime.onInstalled.addListener((function(){chrome.contextMenus.create({title:"Check if trained",contexts:["image"],id:"contextImage"})})),chrome.tabs.onUpdated.addListener((function(o,t,s){"complete"===t.status&&s.active&&(e[o]?e[o].observerState=!0:e[o]={observerState:!0,urls:{images:[],audio:[],video:[],text:[],code:[],other:[],domains:[]}})})),chrome.contextMenus.onClicked.addListener((function(e,o){if(o&&"contextImage"===e.menuItemId&&"image"===e.mediaType){var t=encodeURIComponent(e.srcUrl),s="https://haveibeentrained.com?url=".concat(t);chrome.tabs.create({url:s})}})),void 0!==chrome.action?chrome.action:void 0!==chrome.browserAction&&chrome.browserAction,chrome.runtime.onMessage.addListener((function(o,t,s){var r,n,a;if(console.log("background.tsx: onMessage: request.message: "+o),"ping"===o.message)return console.log("got ping dont worry"),s({message:"background_active"}),!0;var d=(null===(r=t.tab)||void 0===r?void 0:r.id)||o.tabId;return d?(e[d]||(e[d]={observerState:!0,urls:{images:[],audio:[],video:[],text:[],code:[],other:[],domains:[]}}),"page_links"===o.message&&o.urls?(e[d].urls=o.urls,s({status:"received"}),!0):"get_links"===o.message?(s({urls:e[d].urls}),!0):("observer_disconnect"===o.message?(console.log("DIOSCONNECTED"),console.log("observer_disconnect "+d),e[d].observerState=!1,s({status:"observer_disconnected"}),void 0!==o.tabId&&chrome.runtime.sendMessage({message:"observer_disconnect",tabId:o.tabId})):"get_observer_state"===o.message&&(void 0!==o.tabId?(console.log("get observer state"+o.tabId+" "+(null===(n=e[o.tabId])||void 0===n?void 0:n.observerState)),s({observerState:null===(a=e[o.tabId])||void 0===a?void 0:a.observerState})):console.error("Error: tabId is undefined")),console.log(o),s({message:"Unrecognized or unprocessable message"}),!0)):(d=o.tabId,console.log("Error: tabId is undefined"+o.message),!0)})),chrome.tabs.onRemoved.addListener((function(o){delete e[o]}))})();